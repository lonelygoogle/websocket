!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var s=t();for(var n in s)("object"==typeof exports?exports:e)[n]=s[n]}}(this,(function(){return e={138:e=>{e.exports=class{constructor(e){this.domain=e,this.SocketTask=null,this.eventQueue=[],this.allEvent={},this.alreadyConnect=!1,this.reConnectTime=null}initSocket(){this.SocketTask=this.creatSocketLink(),this.listenConnectError(),this.connectSuc(),this.listenSocketClose(),this.listenMessageBack()}creatSocketLink(){return new WebSocket(this.domain)}listenConnectError(){this.SocketTask.onerror=e=>{console.log("连接异常")}}connectSuc(){this.SocketTask.onopen=e=>{this.alreadyConnect=!0,console.log("连接成功"),this.clearAllTime()}}listenSocketClose(){this.SocketTask.onclose=e=>{console.log("连接断开"),this.clearAllTime(),this.alreadyConnect&&(this.reConnectTime=setTimeout((()=>{this.initSocket()}),5e3))}}listenMessageBack(){this.SocketTask.onmessage=({data:e})=>{e=JSON.parge(e),this.allEvent.cb&&this.allEvent.cb(),0!==this.eventQueue.length&&this.eventQueue.forEach((t=>{t.event===e.event&&t.cb(e.msg)}))}}addListener(e,t){this.eventQueue.push({event:e,cb:t})}sendSocketMessage(e){try{this.SocketTask.send(JSON.stringify(e))}catch(e){}}removeListener(e){this.eventQueue.filter((t=>t.event!==e))}addAllListener(e){this.allEvent={cb:e}}removeAllListener(){this.allEvent={}}closeSocket(){this.alreadyConnect&&(this.SocketTask.close(),console.log("手动关闭连接"))}clearAllTime(){this.reConnectTime&&(clearInterval(this.reConnectTime),this.reConnectTimer=null)}}}},t={},function s(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n](o,o.exports,s),o.exports}(138);var e,t}));